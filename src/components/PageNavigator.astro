---
/* 页面导航配置 - 定义站点的所有导航链接 */
const pages = [
  { path: "/", label: "Home" },        /* 首页 */
  { path: "/blog", label: "Blog" },     /* 博客页面 */
  { path: "/components", label: "Comp" },  /* 组件页面 */
  { path: "/inter", label: "Inter" },     /* 交互页面 */
  { path: "/md", label: "MD" },          /* Markdown页面 */
  { path: "/mdx", label: "MDX" },        /* MDX页面 */
  { path: "/static", label: "Static" },  /* 静态页面 */
];

/* 规范化路径函数 - 移除路径末尾的斜杠，除了根路径 */
const normalizePath = (path: string) => {
  if (path === "/") return "/";
  return path.replace(/\/+$/, "");  /* 移除路径末尾的一个或多个斜杠 */
};

/* 获取当前页面路径并规范化 */
const currentPath = normalizePath(Astro.url.pathname);
---

<nav class="page-navigator" id="pageNavigator">  <!-- 页面导航容器 -->
  <ul class="nav-menu" id="navMenu">  <!-- 导航菜单列表 -->
    {
      /* 遍历页面配置数组，生成导航项 */
      pages.map((page) => (
        <li>  <!-- 单个导航项 -->
          <a  /* 导航链接，根据是否为当前页面设置活动状态类 */
            href={page.path}
            class={currentPath === normalizePath(page.path) ? "active" : ""}
          >
            <span class="link-text">{page.label}</span>  <!-- 显示导航标签文本 -->
            {/* 如果是当前页面，则显示活动指示器 */}
            {currentPath === normalizePath(page.path) && (
              <span class="active-indicator">●</span>  <!-- 活动状态指示器 -->
            )}
          </a>
        </li>
      ))
    }
  </ul>
</nav>

<style>
  .page-navigator {
    position: fixed;
    top: 50%;
    right: 2rem;
    bottom: auto;
    z-index: 1000;
    font-family: system-ui, sans-serif;
    transform: translateY(-50%);
  }

  .nav-menu {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    position: relative;
  }

  .nav-menu li {
    margin: 0;
  }

  .nav-menu a {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--ring-size, 56px);
    height: var(--ring-size, 56px);
    border-radius: 50%;
    text-decoration: none;
    color: var(--color-text);
    font-weight: 600;
    font-size: var(--ring-font, clamp(0.45rem, 1vw, 0.56rem));
    line-height: 1.15;
    letter-spacing: 0.01em;
    text-transform: uppercase;
    text-align: center;
    background: rgba(15, 15, 15, 0.72);
    border: 2px solid rgba(255, 255, 255, 0.18);
    backdrop-filter: blur(16px) saturate(180%);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.28);
    transition:
      transform 0.45s cubic-bezier(0.22, 1, 0.36, 1),
      background 0.45s cubic-bezier(0.22, 1, 0.36, 1),
      border-color 0.45s cubic-bezier(0.22, 1, 0.36, 1),
      box-shadow 0.45s cubic-bezier(0.22, 1, 0.36, 1),
      color 0.45s cubic-bezier(0.22, 1, 0.36, 1);
    transform: scale(1);
    overflow: hidden;
    box-sizing: border-box;
    padding: 0.2rem;
  }

  .nav-menu a::before {
    content: "";
    position: absolute;
    inset: 6px;
    border-radius: 50%;
    border: 1px dashed rgba(255, 255, 255, 0.2);
    opacity: 0;
    transform: scale(0.9);
    transition:
      opacity 0.45s cubic-bezier(0.22, 1, 0.36, 1),
      transform 0.45s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .nav-menu a::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: radial-gradient(
      circle at 30% 30%,
      rgba(218, 98, 196, 0.28),
      transparent 65%
    );
    opacity: 0;
    transition: opacity 0.45s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .nav-menu a:hover,
  .nav-menu a:focus-visible {
    background: rgba(79, 57, 250, 0.2);
    border-color: rgba(218, 98, 196, 0.5);
    color: rgb(var(--accent-light));
    transform: scale(1.06);
    box-shadow: 0 12px 26px rgba(79, 57, 250, 0.25);
  }

  .nav-menu a:hover::before,
  .nav-menu a:focus-visible::before,
  .nav-menu a:hover::after,
  .nav-menu a:focus-visible::after {
    opacity: 1;
    transform: scale(1);
  }

  .nav-menu a.active {
    background: linear-gradient(
      145deg,
      rgba(79, 57, 250, 0.3),
      rgba(218, 98, 196, 0.26)
    );
    border-color: rgba(218, 98, 196, 0.65);
    color: rgb(var(--accent-light));
    transform: scale(1.02);
    box-shadow:
      0 14px 28px rgba(79, 57, 250, 0.3),
      0 0 0 4px rgba(79, 57, 250, 0.1);
  }

  .nav-menu a.active::before,
  .nav-menu a.active::after {
    opacity: 1;
    transform: scale(1);
  }

  .nav-menu li:nth-child(1) a,
  .nav-menu li:nth-child(2) a,
  .nav-menu li:nth-child(3) a,
  .nav-menu li:nth-child(4) a,
  .nav-menu li:nth-child(5) a,
  .nav-menu li:nth-child(6) a {
    --ring-size: 56px;
    --ring-font: clamp(0.45rem, 1vw, 0.56rem);
  }

  .link-text {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 100%;
    margin: 0;
    font-size: 1em;
    line-height: 1;
    text-align: center;
    text-transform: inherit;
    letter-spacing: inherit;
    white-space: nowrap;
  }

  .active-indicator {
    position: absolute;
    bottom: 8px;
    right: 10px;
    color: #da62c4;
    font-size: 0.65rem;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
      transform: scale(1);
    }
    50% {
      opacity: 0.6;
      transform: scale(0.9);
    }
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .page-navigator {
      top: 50%;
      right: 1rem;
      bottom: auto;
      transform: translateY(-50%);
    }

    .nav-menu {
      gap: 0.6rem;
    }

    .nav-menu a {
      font-size: clamp(0.42rem, 1.4vw, 0.5rem);
      padding: 0.16rem;
    }

    .nav-menu li:nth-child(1) a,
    .nav-menu li:nth-child(2) a,
    .nav-menu li:nth-child(3) a,
    .nav-menu li:nth-child(4) a,
    .nav-menu li:nth-child(5) a,
    .nav-menu li:nth-child(6) a {
      --ring-size: 48px;
      --ring-font: clamp(0.42rem, 1.4vw, 0.5rem);
    }
  }

  /* Smooth entrance animation */
  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(-50%) translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(-50%);
    }
  }

  .page-navigator {
    animation: slideInUp 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  }
</style>
